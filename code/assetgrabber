#!/usr/bin/env php
<?php

use AssetGrabber\Services\PluginDownloadService;
use AssetGrabber\Services\PluginListService;
use Symfony\Component\Console\Application;

require 'vendor/autoload.php';

$config = require './config/config.php';

$dependencies                       = $config['dependencies'];
$dependencies['services']['config'] = $config;

$container = new \Laminas\ServiceManager\ServiceManager($dependencies);

$application = new Application();

$commands = scandir('./src/Commands');

foreach ($commands as $command) {
    if (strpos($command, 'Command.php') !== false && strpos($command, 'Abstract') === false) {
        $command = str_replace('.php', '', $command);
        $application->add($container->get('AssetGrabber\\Commands\\' . $command));
    }
}
$application->run();
